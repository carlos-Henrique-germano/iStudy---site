<!DOCTYPE html>
<html lang="pt-br">
<head>
	<!-- Meta tags Obrigatórias -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
	integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
	crossorigin="anonymous">

	<!-- Font Awesome (CDN) -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

	<!-- Estilo customizado -->
	<link rel="stylesheet" type="text/css" href="css/estilo.css">

	<title>Dashboard</title>
</head>
<body>

	<!-- Barra de navegação do Dashboard -->
	<nav class="navbar navbar-dashboard">
		<div class="container">
			<span class="navbar-title">Dashboard</span>
			<div class="nav-right">
				<img src="imagens/logo.png" width="50" alt="Logo">
				<button class="navbar-toggler" id="menu-btn">
					<i class="fas fa-bars"></i>
				</button>
			</div>
		</div>
	</nav>

	<!-- Sobreposição escura -->
	<div class="overlay" id="overlay"></div>

	<!-- Menu lateral (sidebar) -->
	<div class="sidebar" id="sidebar">
		<button class="close-btn" id="close-btn">&times;</button>
		<ul>
			<li><a href="index.html">Home</a></li>
			<li><a href="disciplinas.html">Disciplinas</a></li>
			<li><a href="planejamento.html">Planejamento</a></li>
			<li><a href="revisao.html">Revisões</a></li>
			<li><a href="historico.html">Histórico</a></li>
			<li><a href="estatisticas.html">Estatísticas</a></li>
			<li><a href="dados.html">Meus Dados</a></li>
		</ul>
	</div>

	<div id="dashboard">
		<div class="container">
			<div class="lista-dados">
				<div class="card">
					<h2>Tempo de Estudo <i class="fa-solid fa-school"></i></h2>
					<p>00h00</p>
					<a href="estatisticas.html">Ver estatísticas completas</a>
				</div>
				<div class="card">
					<h2>Desempenho <i class="fa-solid fa-building-columns"></i></h2>
					<p>Acertos: --</p>
					<p>Erros: --</p>
					<a href="estatisticas.html">Ver estatísticas completas</a>
				</div>
				<div class="card">
					<h2>Progresso no Edital <i class="fa-solid fa-graduation-cap"></i></h2>
					<p>Tópicos concluídos: --</p>
					<p>Tópicos pendentes: --</p>
					<a href="estatisticas.html">Ver estatísticas completas</a>
				</div>
			</div>
		</div>
	</div>

	<div class="container mt-4">
		<div class="card">
			<h2>Constância nos Estudos <i class="fa-solid fa-fire"></i></h2>
			<div class="study-streak">
				<span id="today"></span>
				<span id="day-6"></span>
				<span id="day-5"></span>
				<span id="day-4"></span>
				<span id="day-3"></span>
				<span id="day-2"></span>
				<span id="day-1"></span>
			</div>
			<button id="mark-study" class="btn btn-success mt-3">Marcar como estudado</button>
		</div>
	</div>

	<div class="container mt-4">
		<div class="card">
			<h2>Disciplinas Cadastradas</h2>
			<table class="table">
				<thead>
					<tr>
						<th>Disciplinas</th>
						<th>Tempo Estudado</th>
						<th>Acertos</th>
						<th>Erros</th>
						<th>Porcentagem de Acertos</th>
					</tr>
				</thead>
				<tbody id="disciplinas-tabela">
					<!-- As disciplinas serão inseridas aqui -->
				</tbody>
			</table>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

<!-- Bootstrap 4.1 -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>


<!-- Botão para abrir o modal -->
<button id="open-modal" class="btn btn-primary mt-2">Registrar Estudo</button>

<!-- Modal de Cadastro -->
<div id="disciplina-modal" class="modal fade" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Registro de Estudo</h5>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-disciplina">
                    <!-- Data de Estudo -->
                    <div class="form-group">
                        <label for="data-estudo">Data de Estudo</label>
                        <input type="date" id="data-estudo" class="form-control">
                    </div>

                    <!-- Linha com Categoria, Disciplina e Tempo de Estudo -->
                    <div class="form-row">
                        <div class="col">
                            <label for="categoria">Categoria</label>
                            <select id="categoria" class="form-control">
                                <option>Fundamentos</option>
                                <option>Programação</option>
                                <option>Infraestrutura</option>
                                <option>Segurança</option>
                            </select>
                        </div>
                        <div class="col">
                            <label for="disciplina">Disciplina</label>
                            <select id="disciplina" class="form-control">
                                <option>Algoritmos</option>
                                <option>Redes de Computadores</option>
                                <option>Banco de Dados</option>
                                <option>Segurança da Informação</option>
                            </select>
                        </div>
                        <div class="col">
                            <label for="tempo-estudo">Tempo de Estudo</label>
                            <input type="text" id="tempo-estudo" class="form-control" placeholder="Ex: 2h30">
                        </div>
                    </div>

                    <!-- Tópicos e Material -->
                    <div class="form-row mt-3">
                        <div class="col-8">
                            <label for="topicos">Tópicos Estudados</label>
                            <textarea id="topicos" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="col-4">
                            <label for="material">Material Utilizado</label>
                            <textarea id="material" class="form-control" rows="3"></textarea>
                        </div>
                    </div>

                    <!-- Checkboxes -->
                    <div class="form-check mt-3">
                        <input type="checkbox" id="questoes-finalizadas" class="form-check-input">
                        <label for="questoes-finalizadas">Questões Finalizadas</label>
                    </div>
                    <div class="form-check">
                        <input type="checkbox" id="programar-revisao" class="form-check-input">
                        <label for="programar-revisao">Programar Revisão</label>
                    </div>

                    <!-- Opções de Revisão -->
                    <div id="revisao-opcoes" class="mt-2 d-none">
                        <label>Escolha a revisão:</label>
                        <select id="dias-revisao" class="form-control">
                            <option>1 dia</option>
                            <option>3 dias</option>
                            <option>5 dias</option>
                            <option>7 dias</option>
                            <option>Personalizada</option>
                        </select>
                        <input type="date" id="data-personalizada" class="form-control mt-2 d-none">
                    </div>

                    <!-- Acertos, Páginas Lidas e Vídeo Aula -->
                    <div class="form-row mt-3">
                        <div class="col">
                            <label for="acertos">Acertos</label>
                            <input type="number" id="acertos" class="form-control">
                        </div>
                        <div class="col">
                            <label for="erros">Erros</label>
                            <input type="number" id="erros" class="form-control">
                        </div>
                    </div>

                    <div class="form-row mt-3">
                        <div class="col">
                            <label for="pagina-inicio">Página Início</label>
                            <input type="number" id="pagina-inicio" class="form-control">
                        </div>
                        <div class="col">
                            <label for="pagina-fim">Página Fim</label>
                            <input type="number" id="pagina-fim" class="form-control">
                        </div>
                    </div>

                    <div class="form-group mt-3">
                        <label>Assistiu Vídeo Aula?</label>
                        <select id="video-aula" class="form-control">
                            <option>Não</option>
                            <option>Sim</option>
                        </select>
                        <input type="text" id="tempo-video" class="form-control mt-2 d-none" placeholder="Tempo de Vídeo (Ex: 40min)">
                    </div>

                    <button type="submit" class="btn btn-success btn-block mt-3">Salvar</button>
                </form>
            </div>
        </div>
    </div>
</div>

		</div>
	</div>

	<!-- Script para o menu lateral -->
	<script>
		document.getElementById("menu-btn").addEventListener("click", function() {
			document.getElementById("sidebar").classList.add("active");
			document.getElementById("overlay").classList.add("active");
		});

		document.getElementById("close-btn").addEventListener("click", function() {
			document.getElementById("sidebar").classList.remove("active");
			document.getElementById("overlay").classList.remove("active");
		});

		document.getElementById("overlay").addEventListener("click", function() {
			document.getElementById("sidebar").classList.remove("active");
			this.classList.remove("active");
		});
	</script>

	<!--Script para a Sequência de Dias estudados-->
	<script>
		document.addEventListener("DOMContentLoaded", function () {
			const studyKey = "study-streak";
			const days = 7;
			let studyData = JSON.parse(localStorage.getItem(studyKey)) || {};

			function getFormattedDate(daysAgo = 0) {
				let date = new Date();
				date.setDate(date.getDate() - daysAgo);
				return date.toISOString().split("T")[0];
			}

			function updateUI() {
				let today = getFormattedDate();
				for (let i = 0; i < days; i++) {
					let dayDate = getFormattedDate(days - 1 - i);
					let el = document.getElementById(i === days - 1 ? "today" : `day-${i}`);

                if (!el) continue; // Proteção contra erro caso o elemento não exista
                
                el.className = ""; // Resetando classes
                if (i === days - 1) el.classList.add("today");

                if (studyData[dayDate] === true) {
                	el.textContent = "✔️";
                	el.classList.add("studied");
                } else if (studyData[dayDate] === false) {
                	el.textContent = "❌";
                	el.classList.add("missed");
                } else {
                	el.textContent = "";
                }
            }
        }

        document.getElementById("mark-study").addEventListener("click", function () {
        	let today = getFormattedDate();
        	studyData[today] = true;
        	localStorage.setItem(studyKey, JSON.stringify(studyData));
        	updateUI();
        });

        updateUI();
    });
</script>

<!-- Script para adicionar disciplina -->
<script>
	document.addEventListener("DOMContentLoaded", function () {
		const disciplinasKey = "disciplinas";
		let disciplinas = JSON.parse(localStorage.getItem(disciplinasKey)) || [];

		function atualizarTabela() {
			const tabela = document.getElementById("disciplinas-tabela");
			tabela.innerHTML = "";

			disciplinas.forEach((disciplina, index) => {
				let porcentagem = disciplina.acertos + disciplina.erros > 0 ? 
				((disciplina.acertos / (disciplina.acertos + disciplina.erros)) * 100).toFixed(1) + "%" : "0%";

				let linha = `
                    <tr>
                        <td>${disciplina.nome}</td>
                        <td>${disciplina.tempo}</td>
                        <td>${disciplina.acertos}</td>
                        <td>${disciplina.erros}</td>
                        <td>${porcentagem}</td>
                    </tr>
				`;
				tabela.innerHTML += linha;
			});

			localStorage.setItem(disciplinasKey, JSON.stringify(disciplinas));
		}

		atualizarTabela();
	});
	</script>

	<!-- Script para adicionar registro de estudo -->

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("form-disciplina");
        const programarRevisao = document.getElementById("programar-revisao");
        const revisaoOpcoes = document.getElementById("revisao-opcoes");
        const diasRevisao = document.getElementById("dias-revisao");
        const dataPersonalizada = document.getElementById("data-personalizada");
        const videoAula = document.getElementById("video-aula");
        const tempoVideo = document.getElementById("tempo-video");
        const tabela = document.getElementById("disciplinas-tabela");
        const disciplinasKey = "disciplinas";

        let disciplinas = JSON.parse(localStorage.getItem(disciplinasKey)) || [];

        // Exibir modal ao clicar no botão
        document.getElementById("open-modal").addEventListener("click", function () {
            console.log("Abrindo modal...");
            $("#disciplina-modal").modal("show");
        });

        // Mostrar ou ocultar opções de revisão
        programarRevisao.addEventListener("change", function () {
            revisaoOpcoes.classList.toggle("d-none", !this.checked);
        });

        // Mostrar campo para data personalizada
        diasRevisao.addEventListener("change", function () {
            dataPersonalizada.classList.toggle("d-none", this.value !== "Personalizada");
        });

        // Mostrar campo de tempo de vídeo se assistir aula
        videoAula.addEventListener("change", function () {
            tempoVideo.classList.toggle("d-none", this.value !== "Sim");
        });

        function atualizarTabela() {
            tabela.innerHTML = "";

            disciplinas.forEach((disciplina, index) => {
                let porcentagem = disciplina.acertos + disciplina.erros > 0 ? 
                    ((disciplina.acertos / (disciplina.acertos + disciplina.erros)) * 100).toFixed(1) + "%" : "0%";

                let linha = `
                    <tr>
                        <td>${disciplina.disciplina}</td>
                        <td>${disciplina.tempo}</td>
                        <td>${disciplina.acertos}</td>
                        <td>${disciplina.erros}</td>
                        <td>${porcentagem}</td>
                    </tr>
                `;
                tabela.innerHTML += linha;
            });

            localStorage.setItem(disciplinasKey, JSON.stringify(disciplinas));
        }

        form.addEventListener("submit", function (event) {
            event.preventDefault();

            console.log("Salvando disciplina...");

            const estudo = {
                data: document.getElementById("data-estudo").value,
                categoria: document.getElementById("categoria").value,
                disciplina: document.getElementById("disciplina").value,
                tempo: document.getElementById("tempo-estudo").value,
                topicos: document.getElementById("topicos").value,
                material: document.getElementById("material").value,
                questoesFinalizadas: document.getElementById("questoes-finalizadas").checked,
                programarRevisao: programarRevisao.checked ? diasRevisao.value : null,
                dataPersonalizada: dataPersonalizada.value || null,
                acertos: parseInt(document.getElementById("acertos").value) || 0,
                erros: parseInt(document.getElementById("erros").value) || 0,
                paginaInicio: document.getElementById("pagina-inicio").value,
                paginaFim: document.getElementById("pagina-fim").value,
                videoAula: videoAula.value,
                tempoVideo: tempoVideo.value || null
            };

            disciplinas.push(estudo);
            atualizarTabela();

            alert("Disciplina adicionada!");
            $("#disciplina-modal").modal("hide");
            form.reset();
        });

        atualizarTabela();
    });
</script>


</body>
</html>
